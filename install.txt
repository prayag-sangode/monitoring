helm repo add prometheus-community https://prometheus-community.github.io/helm-charts
helm install prometheus-node-exporter prometheus-community/prometheus-node-exporter --version 4.42.0 --create-namespace -n monitoring

helm repo add prometheus-community https://prometheus-community.github.io/helm-charts
helm upgrade --install  prometheus prometheus-community/prometheus -f prometheus-values.yaml --version 25.26.0 --create-namespace -n monitoring



helm repo add grafana https://grafana.github.io/helm-charts
helm upgrade --install grafana grafana/grafana -f grafana-values.yaml --version 8.4.5 --create-namespace -n monitoring

kubectl get secret --namespace monitoring grafana -o jsonpath="{.data.admin-password}" | base64 --decode ; echo

kubectl create secret generic postgres-credentials \
  --from-literal=DATA_SOURCE_NAME="postgresql://aifs_files:<replace-me>@10.1.58.99:5432/aifs_files?sslmode=disable" \
  -n monitoring

kubectl get secrets postgres-credentials -n monitoring -o yaml


helm repo add prometheus-community https://prometheus-community.github.io/helm-charts
helm repo update

helm install postgresql-exporter prometheus-community/prometheus-postgres-exporter \
  --namespace monitoring --create-namespace \
  --set envFrom[0].secretRef.name=postgres-credentials

scrape_configs:
  - job_name: 'postgresql'
    static_configs:
      - targets: 
         - postgresql-exporter.monitoring.svc.cluster.local
